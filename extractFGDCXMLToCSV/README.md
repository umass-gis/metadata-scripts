# extractFGDCXMLToCSV.py
This Python script iterates through multiple XML files generated by the [Export Metadata Multiple](https://desktop.arcgis.com/en/arcmap/latest/tools/conversion-toolbox/export-metadata-multiple.htm) tool in ArcMap. It retrieves each item's title and bounding coordinates, then generates a single CSV file with the aggregated information. The script is designed to extract relevant information about a georeferenced raster (aerial photo) for the UMass Amherst MacConnell Aerial Photo project. It will need to be customized before it can be used for other XML files.

To try out the script, the `test_xml.zip` package contains 16 sample XML files of georeferenced aerial photos of the town of Amherst, MA.

These are the fields which are extracted and/or calculated:
* `title` - filename of the aerial photo
* `identifier` - input to `dct_identifier_sm`
* `west` - west bounding coordinate
* `east` - east bounding coordinate
* `north` - north bounding coordinate
* `south` - north bounding coordinate
* `bbox` - input to `locn_geometry`, formatted as "ENVELOPE(W, E, N, S)"

## Customizations
`directoryPath` - if placed in the same folder as the XML files, this part of the code can be left as is. Otherwise, type the  path location to the folder where the XML files are stored (e.g. '/users/yourname/Desktop/xml').

`cols` - update this list with the column headings that should appear in the output CSV. These fields will need to be edited for the variable `this_df` as well.

`for citeinfo` and `for bounding` - these parts of the script use the xml.etree.ElementTree library to search for information within the XML file based on specific tags.
* For XML files with multiple children, see the Python docs help on [Parsing XML](https://docs.python.org/3/library/xml.etree.elementtree.html#parsing-xml)
* For locating buried elements in a tree, see the Python docs help on [XPath support](https://docs.python.org/3/library/xml.etree.elementtree.html#xpath-support)

`this_df` - there are two calculated fields in the present code, which take the extracted title and coordinate information and format it according to the GeoBlacklight Aaardvark metadata schema.
